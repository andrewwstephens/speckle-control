
proc updateDatabase { } {
global ANDOR_ARM ANDOR_CFG TELEMETRY SCOPE
   set finsert [open /tmp/insert_$ANDOR_ARM.sql w]
   puts $finsert "INSERT INTO Speckle_Observations VALUES (NOW(6),'$SCOPE(ProgID)','$TELEMETRY(speckle.scope.target)','$ANDOR_CFG(imagename)','$TELEMETRY(speckle.scope.datatype)',$TELEMETRY(speckle.andor.preamp_gain),$TELEMETRY(speckle.andor.em_gain),$TELEMETRY(speckle.andor.bias),$TELEMETRY(speckle.andor.peak),$TELEMETRY(speckle.andor.int_time),$TELEMETRY(speckle.andor.exposureStart),$TELEMETRY(speckle.andor.exposureEnd),'$SCOPE(filter)','$ANDOR_CFG($ANDOR_ARM,OutputAmplifier)',$TELEMETRY(speckle.andor.numexp),$TELEMETRY(speckle.andor.numaccum),'$TELEMETRY(speckle.andor.roi)',$TELEMETRY(speckle.andor.hbin),$TELEMETRY(speckle.andor.vbin),'$TELEMETRY(tcs.telescope.ra)','$TELEMETRY(tcs.telescope.dec)',$TELEMETRY(tcs.weather.rawiq),$TELEMETRY(tcs.weather.rawcc),$TELEMETRY(tcs.weather.rawwv),$TELEMETRY(tcs.weather.rawbg));"
   close $finsert
   catch {exec mysql speckle --user=root < /tmp/insert_$ANDOR_ARM.sql >& /tmp/insert_$ANDOR_ARM.log &}
}

set TELEMETRY(speckle.scope.target) M1
set ANDOR_ARM red
set ANDOR_CFG(imagename) testimage
set TELEMETRY(speckle.scope.datatype) long
set TELEMETRY(speckle.andor.bias) 1000
set TELEMETRY(speckle.andor.peak) 5000
set ANDOR_CFG(red,OutputAmplifier) 0
set TELEMETRY(speckle.andor.numexp) 1
set TELEMETRY(tcs.weather.rawiq) 50 
set TELEMETRY(tcs.weather.rawcc) 50
set TELEMETRY(tcs.weather.rawwv) 50
set TELEMETRY(tcs.weather.rawbg) 50




