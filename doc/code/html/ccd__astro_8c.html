<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Speckle Instrument Control and GUI: ccd_astro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dssi.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Speckle Instrument Control and GUI
   &#160;<span id="projectnumber">1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ccd_astro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Astrometric routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ccd_astro.c:</div>
<div class="dyncontent">
<div class="center"><img src="ccd__astro_8c__incl.png" border="0" usemap="#ccd__astro_8c" alt=""/></div>
</div>
</div>
<p><a href="ccd__astro_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4f290ef8550589b60e07c92fe19e06cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(x)&#160;&#160;&#160;((x)*<a class="el" href="ccd__astro_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/180.)</td></tr>
<tr class="separator:a4f290ef8550589b60e07c92fe19e06cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e9da27d3ef91d14d3f049dc591f220"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(x)&#160;&#160;&#160;((x)*180./<a class="el" href="ccd__astro_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)</td></tr>
<tr class="separator:a14e9da27d3ef91d14d3f049dc591f220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae118c4a78016f5ff238c297ee568bfe1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#ae118c4a78016f5ff238c297ee568bfe1">hrdeg</a>(x)&#160;&#160;&#160;((x)*15.)</td></tr>
<tr class="separator:ae118c4a78016f5ff238c297ee568bfe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e7b5b636d7d8a44548f25b991a0562"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a23e7b5b636d7d8a44548f25b991a0562">deghr</a>(x)&#160;&#160;&#160;((x)/15.)</td></tr>
<tr class="separator:a23e7b5b636d7d8a44548f25b991a0562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6decddc4963c95defff0266089716730"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a6decddc4963c95defff0266089716730">hrrad</a>(x)&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(<a class="el" href="ccd__astro_8c.html#ae118c4a78016f5ff238c297ee568bfe1">hrdeg</a>(x))</td></tr>
<tr class="separator:a6decddc4963c95defff0266089716730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64bcc0020d85100174c95e50e916b15a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a64bcc0020d85100174c95e50e916b15a">radhr</a>(x)&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a23e7b5b636d7d8a44548f25b991a0562">deghr</a>(<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(x))</td></tr>
<tr class="separator:a64bcc0020d85100174c95e50e916b15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5263fe8b4034adaa87390477bacd874"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(x)&#160;&#160;&#160;cos(<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(x))</td></tr>
<tr class="separator:ab5263fe8b4034adaa87390477bacd874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff931f8163297e4b4d26cff78c29621d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(x)&#160;&#160;&#160;sin(<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(x))</td></tr>
<tr class="separator:aff931f8163297e4b4d26cff78c29621d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d7f1d879501873bf3477409898f2c77"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a0d7f1d879501873bf3477409898f2c77">DASIN</a>(x)&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(asin(x))</td></tr>
<tr class="separator:a0d7f1d879501873bf3477409898f2c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c3f6c06c99f5f2aa436f253104fc99f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a3c3f6c06c99f5f2aa436f253104fc99f">DATAN2</a>(y, x)&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(atan2((y),(x)))</td></tr>
<tr class="separator:a3c3f6c06c99f5f2aa436f253104fc99f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c22d077b2c872fa05d3482ea45caac"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a17c22d077b2c872fa05d3482ea45caac">MJD0</a>&#160;&#160;&#160;2415020.0               /* 1900 Jan 0.5 (noon)   */</td></tr>
<tr class="separator:a17c22d077b2c872fa05d3482ea45caac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd09200b4253bfff7b9a890591e09292"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#afd09200b4253bfff7b9a890591e09292">J2000</a>&#160;&#160;&#160;(2451545.0 - <a class="el" href="ccd__astro_8c.html#a17c22d077b2c872fa05d3482ea45caac">MJD0</a>)      /* let compiler optimise */</td></tr>
<tr class="separator:afd09200b4253bfff7b9a890591e09292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03bc5507beb566bb1956c9a53110deb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#ad03bc5507beb566bb1956c9a53110deb">MJDF0</a>&#160;&#160;&#160;2400000.5               /* Recommended FITS/OGIP zero for MJD */</td></tr>
<tr class="separator:ad03bc5507beb566bb1956c9a53110deb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a>&#160;&#160;&#160;3.141592653589793</td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a339259d0a0e3e4de8593894ac41b2313"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a339259d0a0e3e4de8593894ac41b2313">SIDRATE</a>&#160;&#160;&#160;0.9972695677    /* ratio of synodic to sidereal rate */</td></tr>
<tr class="separator:a339259d0a0e3e4de8593894ac41b2313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fee30674709bf7cf2601f2e499372cf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a3fee30674709bf7cf2601f2e499372cf">SPD</a>&#160;&#160;&#160;(24.0*3600.0)   /* seconds per day */</td></tr>
<tr class="separator:a3fee30674709bf7cf2601f2e499372cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aae1165f6e4eb1d6d3292e28b1f8640f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#aae1165f6e4eb1d6d3292e28b1f8640f6">precess</a> (double <a class="el" href="ccd__astro_8c.html#afd09200b4253bfff7b9a890591e09292">J2000</a>, double jd, double *ra, double *dec)</td></tr>
<tr class="memdesc:aae1165f6e4eb1d6d3292e28b1f8640f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Precess coordinates.  <a href="#aae1165f6e4eb1d6d3292e28b1f8640f6">More...</a><br /></td></tr>
<tr class="separator:aae1165f6e4eb1d6d3292e28b1f8640f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f97bc2c6a39966a664c3b924d5eacb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a95f97bc2c6a39966a664c3b924d5eacb">range</a> (double *v, double r)</td></tr>
<tr class="separator:a95f97bc2c6a39966a664c3b924d5eacb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6f866f9e7bebfc1001ec63efdb44a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#afa6f866f9e7bebfc1001ec63efdb44a7">mjd_year</a> (double mjd, double *yr)</td></tr>
<tr class="memdesc:afa6f866f9e7bebfc1001ec63efdb44a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate MJD year.  <a href="#afa6f866f9e7bebfc1001ec63efdb44a7">More...</a><br /></td></tr>
<tr class="separator:afa6f866f9e7bebfc1001ec63efdb44a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7d4965d4cd932c046ad5416b2a75d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#ade7d4965d4cd932c046ad5416b2a75d3">to_uppercase</a> (char *keyword, int nchar)</td></tr>
<tr class="separator:ade7d4965d4cd932c046ad5416b2a75d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ac3d1dc354cda2cd6064841ec6d978"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a78ac3d1dc354cda2cd6064841ec6d978">hjd</a> (double jd, double dra, double ddec)</td></tr>
<tr class="separator:a78ac3d1dc354cda2cd6064841ec6d978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5ebe59481b38a5d393554a2b7ca9a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a> (int mn, double dy, int yr, double *mjd)</td></tr>
<tr class="separator:a0c5ebe59481b38a5d393554a2b7ca9a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de792bd2e3b0e68f0f2fbaf67547b77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#a7de792bd2e3b0e68f0f2fbaf67547b77">mjd_cal</a> (double mjd, int *mn, double *dy, int *yr)</td></tr>
<tr class="separator:a7de792bd2e3b0e68f0f2fbaf67547b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac63bb3146f5155f9ab55477883d6e7fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ccd__astro_8c.html#ac63bb3146f5155f9ab55477883d6e7fd">year_mjd</a> (double y, double *mjd)</td></tr>
<tr class="separator:ac63bb3146f5155f9ab55477883d6e7fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Astrometric routines. </p>
<p>Written May 29, 1999 by Ken Sills </p>

<p>Definition in file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a0d7f1d879501873bf3477409898f2c77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DASIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(asin(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00040">40</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3c3f6c06c99f5f2aa436f253104fc99f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATAN2</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(atan2((y),(x)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00041">41</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab5263fe8b4034adaa87390477bacd874"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DCOS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;cos(<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00038">38</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a23e7b5b636d7d8a44548f25b991a0562"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define deghr</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)/15.)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00032">32</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4f290ef8550589b60e07c92fe19e06cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define degrad</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)*<a class="el" href="ccd__astro_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a>/180.)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00029">29</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="aff931f8163297e4b4d26cff78c29621d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DSIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;sin(<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00039">39</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae118c4a78016f5ff238c297ee568bfe1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hrdeg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)*15.)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00031">31</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6decddc4963c95defff0266089716730"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define hrrad</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(<a class="el" href="ccd__astro_8c.html#ae118c4a78016f5ff238c297ee568bfe1">hrdeg</a>(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00033">33</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="afd09200b4253bfff7b9a890591e09292"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define J2000&#160;&#160;&#160;(2451545.0 - <a class="el" href="ccd__astro_8c.html#a17c22d077b2c872fa05d3482ea45caac">MJD0</a>)      /* let compiler optimise */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00046">46</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a17c22d077b2c872fa05d3482ea45caac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MJD0&#160;&#160;&#160;2415020.0               /* 1900 Jan 0.5 (noon)   */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00045">45</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad03bc5507beb566bb1956c9a53110deb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MJDF0&#160;&#160;&#160;2400000.5               /* Recommended FITS/OGIP zero for MJD */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00047">47</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a598a3330b3c21701223ee0ca14316eca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PI&#160;&#160;&#160;3.141592653589793</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00048">48</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a14e9da27d3ef91d14d3f049dc591f220"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define raddeg</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)*180./<a class="el" href="ccd__astro_8c.html#a598a3330b3c21701223ee0ca14316eca">PI</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00030">30</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a64bcc0020d85100174c95e50e916b15a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define radhr</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="ccd__astro_8c.html#a23e7b5b636d7d8a44548f25b991a0562">deghr</a>(<a class="el" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00034">34</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a339259d0a0e3e4de8593894ac41b2313"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SIDRATE&#160;&#160;&#160;0.9972695677    /* ratio of synodic to sidereal rate */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00052">52</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3fee30674709bf7cf2601f2e499372cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPD&#160;&#160;&#160;(24.0*3600.0)   /* seconds per day */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00053">53</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0c5ebe59481b38a5d393554a2b7ca9a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cal_mjd </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>yr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mjd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00149">149</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> last_mjd, last_dy;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> last_mn, last_yr;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> b, d, m, y;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">long</span> c;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">if</span> (mn == last_mn &amp;&amp; yr == last_yr &amp;&amp; dy == last_dy) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    *mjd = last_mjd;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  m = mn;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  y = (yr &lt; 0) ? yr + 1 : yr;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">if</span> (mn &lt; 3) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    m += 12;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    y -= 1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="keywordflow">if</span> (yr &lt; 1582 || (yr == 1582 &amp;&amp; (mn &lt; 10 || (mn == 10 &amp;&amp; dy &lt; 15))))</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    b = 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordtype">int</span> a;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    a = y/100;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    b = 2 - a + a/4;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">if</span> (y &lt; 0)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    c = (long)((365.25*y) - 0.75) - 694025L;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    c = (long)(365.25*y) - 694025L;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  d = 30.6001*(m+1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  *mjd = b + c + d + dy - 0.5;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  last_mn = mn;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  last_dy = dy;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  last_yr = yr;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  last_mjd = *mjd;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a78ac3d1dc354cda2cd6064841ec6d978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double hjd </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ddec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00093">93</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> e;        <span class="comment">/* obliquity of ecliptic */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">double</span> n;        <span class="comment">/* day number */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">double</span> g;        <span class="comment">/* solar mean anomaly */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">double</span> L;        <span class="comment">/* solar ecliptic longitude */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">double</span> l;        <span class="comment">/* mean solar ecliptic longitude */</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">double</span> R;        <span class="comment">/* sun distance, AU */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">double</span> X, Y;         <span class="comment">/* equatorial rectangular solar coords */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordtype">double</span> cdec, sdec;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">double</span> cra, sra;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">double</span> deltajd;      <span class="comment">/* HJD = JD - deltajd */</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">double</span> ra, dec;    <span class="comment">/* RA, Dec in radians */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">/* convert RA and Dec to radians */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  ra = <a class="code" href="ccd__astro_8c.html#a64bcc0020d85100174c95e50e916b15a">radhr</a>(dra);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  dec = <a class="code" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(ddec);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">   * precess from J2000 (input equinox) to the observation equinox,</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">   * where times are given in MJD</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="ccd__astro_8c.html#aae1165f6e4eb1d6d3292e28b1f8640f6">precess</a>((<span class="keywordtype">double</span>)<a class="code" href="ccd__astro_8c.html#afd09200b4253bfff7b9a890591e09292">J2000</a>, (<span class="keywordtype">double</span>)(jd - <a class="code" href="ccd__astro_8c.html#a17c22d077b2c872fa05d3482ea45caac">MJD0</a>), &amp;ra, &amp;dec);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">/* do it to it */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  cdec = cos(dec);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  sdec = sin(dec);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  cra = cos(ra);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  sra = sin(ra);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  n = jd - 2451545.0;   <span class="comment">/* use epoch 2000 */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  e = <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(23.439 - 0.0000004*n);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  g = <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(357.528) + <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(0.9856003)*n;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  L = <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(280.461) + <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(0.9856474)*n;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  l = L + <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(1.915)*sin(g) + <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(0.02)*sin(2.0*g);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  R = 1.00014 - 0.01671*cos(g) - 0.00014*cos(2.0*g);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  X = R*cos(l);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  Y = R*cos(e)*sin(l);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  deltajd = 0.0057755 * (cdec*cra*X + (cdec*sra + tan(e)*sdec)*Y);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">return</span>(jd-deltajd);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="ttc" id="ccd__astro_8c_html_a64bcc0020d85100174c95e50e916b15a"><div class="ttname"><a href="ccd__astro_8c.html#a64bcc0020d85100174c95e50e916b15a">radhr</a></div><div class="ttdeci">#define radhr(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00034">ccd_astro.c:34</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_aae1165f6e4eb1d6d3292e28b1f8640f6"><div class="ttname"><a href="ccd__astro_8c.html#aae1165f6e4eb1d6d3292e28b1f8640f6">precess</a></div><div class="ttdeci">void precess(double J2000, double jd, double *ra, double *dec)</div><div class="ttdoc">Precess coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00224">ccd_astro.c:224</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a14e9da27d3ef91d14d3f049dc591f220"><div class="ttname"><a href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a></div><div class="ttdeci">#define raddeg(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00030">ccd_astro.c:30</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_afd09200b4253bfff7b9a890591e09292"><div class="ttname"><a href="ccd__astro_8c.html#afd09200b4253bfff7b9a890591e09292">J2000</a></div><div class="ttdeci">#define J2000</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00046">ccd_astro.c:46</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a4f290ef8550589b60e07c92fe19e06cd"><div class="ttname"><a href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a></div><div class="ttdeci">#define degrad(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00029">ccd_astro.c:29</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a17c22d077b2c872fa05d3482ea45caac"><div class="ttname"><a href="ccd__astro_8c.html#a17c22d077b2c872fa05d3482ea45caac">MJD0</a></div><div class="ttdeci">#define MJD0</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00045">ccd_astro.c:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7de792bd2e3b0e68f0f2fbaf67547b77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mjd_cal </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>mn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>yr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00341">341</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> last_mjd, last_dy;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> last_mn, last_yr;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">double</span> d, f;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">double</span> i, a, b, ce, g;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">/* MJD 0 = noon the last day of 1899. */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (mjd == 0.0) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    *mn = 12;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    *dy = 31.5;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    *yr = 1899;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (mjd == last_mjd) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    *mn = last_mn;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    *yr = last_yr;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    *dy = last_dy;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  d = mjd + 0.5;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  i = floor(d);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  f = d-i;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> (f == 1) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    f = 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    i += 1;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">if</span> (i &gt; -115860.0) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    a = floor((i/36524.25)+.99835726)+14;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    i += 1 + a - floor(a/4.0);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  b = floor((i/365.25)+.802601);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  ce = i - floor((365.25*b)+.750001)+416;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  g = floor(ce/30.6001);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  *mn = g - 1;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  *dy = ce - floor(30.6001*g)+f;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  *yr = b + 1899;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (g &gt; 13.5)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    *mn = g - 13;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">if</span> (*mn &lt; 2.5)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    *yr = b + 1900;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> (*yr &lt; 1)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    *yr -= 1;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  last_mn = *mn;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  last_dy = *dy;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  last_yr = *yr;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  last_mjd = mjd;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afa6f866f9e7bebfc1001ec63efdb44a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mjd_year </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>yr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate MJD year. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mjd</td><td>Mean Julian Data </td></tr>
    <tr><td class="paramname">yr</td><td>Year </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00408">408</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;{</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> last_mjd, last_yr;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">int</span> m, y;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordtype">double</span> d;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">double</span> e0, e1;    <span class="comment">/* mjd of start of this year, start of next year */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (mjd == last_mjd) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    *yr = last_yr;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <a class="code" href="ccd__astro_8c.html#a7de792bd2e3b0e68f0f2fbaf67547b77">mjd_cal</a> (mjd, &amp;m, &amp;d, &amp;y);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keywordflow">if</span> (y == -1) y = -2;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a> (1, 1.0, y, &amp;e0);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a> (1, 1.0, y+1, &amp;e1);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  *yr = y + (mjd - e0)/(e1 - e0);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  last_mjd = mjd;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  last_yr = *yr;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="ccd__astro_8c_html_a0c5ebe59481b38a5d393554a2b7ca9a6"><div class="ttname"><a href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a></div><div class="ttdeci">void cal_mjd(int mn, double dy, int yr, double *mjd)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00149">ccd_astro.c:149</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a7de792bd2e3b0e68f0f2fbaf67547b77"><div class="ttname"><a href="ccd__astro_8c.html#a7de792bd2e3b0e68f0f2fbaf67547b77">mjd_cal</a></div><div class="ttdeci">void mjd_cal(double mjd, int *mn, double *dy, int *yr)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00341">ccd_astro.c:341</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae1165f6e4eb1d6d3292e28b1f8640f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void precess </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>J2000</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>jd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Precess coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">J2000</td><td>epoch </td></tr>
    <tr><td class="paramname">jd</td><td>Julian date </td></tr>
    <tr><td class="paramname">ra</td><td>RA </td></tr>
    <tr><td class="paramname">dec</td><td>DEC </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00224">224</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> last_mjd1 = -213.432, last_from;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> last_mjd2 = -213.432, last_to;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordtype">double</span> zeta_A, z_A, theta_A;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">double</span> T;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">double</span> A, B, C;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">double</span> alpha, delta;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">double</span> alpha_in, delta_in;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">double</span> from_equinox, to_equinox;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">double</span> alpha2000, delta2000;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="comment">/* convert mjds to years */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (last_mjd1 == mjd1)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    from_equinox = last_from;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="ccd__astro_8c.html#afa6f866f9e7bebfc1001ec63efdb44a7">mjd_year</a> (mjd1, &amp;from_equinox);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    last_mjd1 = mjd1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    last_from = from_equinox;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">if</span> (last_mjd2 == mjd2)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    to_equinox = last_to;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="ccd__astro_8c.html#afa6f866f9e7bebfc1001ec63efdb44a7">mjd_year</a> (mjd2, &amp;to_equinox);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    last_mjd2 = mjd2;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    last_to = to_equinox;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">/* convert coords in rads to degs */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  alpha_in = <a class="code" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(*ra);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  delta_in = <a class="code" href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a>(*dec);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">/* precession progresses about 1 arc second in .047 years */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">/* From from_equinox to 2000.0 */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">if</span> (fabs((<span class="keywordtype">double</span>)(from_equinox-2000.0)) &gt; .04) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    T = (from_equinox - 2000.0)/100.0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    zeta_A  = 0.6406161* T + 0.0000839* T*T + 0.0000050* T*T*T;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    z_A     = 0.6406161* T + 0.0003041* T*T + 0.0000051* T*T*T;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    theta_A = 0.5567530* T - 0.0001185* T*T - 0.0000116* T*T*T;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    A = <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(alpha_in - z_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta_in);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    B = <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(alpha_in - z_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta_in)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                             + <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(delta_in);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    C = -<a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(alpha_in - z_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta_in)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                              + <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(delta_in);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    alpha2000 = <a class="code" href="ccd__astro_8c.html#a3c3f6c06c99f5f2aa436f253104fc99f">DATAN2</a>(A,B) - zeta_A;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="ccd__astro_8c.html#a95f97bc2c6a39966a664c3b924d5eacb">range</a> (&amp;alpha2000, 360.0);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    delta2000 = <a class="code" href="ccd__astro_8c.html#a0d7f1d879501873bf3477409898f2c77">DASIN</a>(C);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    alpha2000 = alpha_in;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    delta2000 = delta_in;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  };</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">/* From 2000.0 to to_equinox */</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (fabs (to_equinox - 2000.0) &gt; .04) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    T = (to_equinox - 2000.0)/100.0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    zeta_A  = 0.6406161* T + 0.0000839* T*T + 0.0000050* T*T*T;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    z_A     = 0.6406161* T + 0.0003041* T*T + 0.0000051* T*T*T;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    theta_A = 0.5567530* T - 0.0001185* T*T - 0.0000116* T*T*T;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    A = <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(alpha2000 + zeta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta2000);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    B = <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(alpha2000 + zeta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta2000)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      - <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(delta2000);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    C = <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(alpha2000 + zeta_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(delta2000)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      + <a class="code" href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a>(theta_A) * <a class="code" href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a>(delta2000);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    alpha = <a class="code" href="ccd__astro_8c.html#a3c3f6c06c99f5f2aa436f253104fc99f">DATAN2</a>(A,B) + z_A;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="ccd__astro_8c.html#a95f97bc2c6a39966a664c3b924d5eacb">range</a>(&amp;alpha, 360.0);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    delta = <a class="code" href="ccd__astro_8c.html#a0d7f1d879501873bf3477409898f2c77">DASIN</a>(C);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    alpha = alpha2000;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    delta = delta2000;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  };</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  *ra = <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(alpha);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  *dec = <a class="code" href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a>(delta);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div>
<div class="ttc" id="ccd__astro_8c_html_a3c3f6c06c99f5f2aa436f253104fc99f"><div class="ttname"><a href="ccd__astro_8c.html#a3c3f6c06c99f5f2aa436f253104fc99f">DATAN2</a></div><div class="ttdeci">#define DATAN2(y, x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00041">ccd_astro.c:41</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_aff931f8163297e4b4d26cff78c29621d"><div class="ttname"><a href="ccd__astro_8c.html#aff931f8163297e4b4d26cff78c29621d">DSIN</a></div><div class="ttdeci">#define DSIN(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00039">ccd_astro.c:39</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a0d7f1d879501873bf3477409898f2c77"><div class="ttname"><a href="ccd__astro_8c.html#a0d7f1d879501873bf3477409898f2c77">DASIN</a></div><div class="ttdeci">#define DASIN(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00040">ccd_astro.c:40</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a14e9da27d3ef91d14d3f049dc591f220"><div class="ttname"><a href="ccd__astro_8c.html#a14e9da27d3ef91d14d3f049dc591f220">raddeg</a></div><div class="ttdeci">#define raddeg(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00030">ccd_astro.c:30</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_afa6f866f9e7bebfc1001ec63efdb44a7"><div class="ttname"><a href="ccd__astro_8c.html#afa6f866f9e7bebfc1001ec63efdb44a7">mjd_year</a></div><div class="ttdeci">void mjd_year(double mjd, double *yr)</div><div class="ttdoc">Calculate MJD year. </div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00408">ccd_astro.c:408</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_ab5263fe8b4034adaa87390477bacd874"><div class="ttname"><a href="ccd__astro_8c.html#ab5263fe8b4034adaa87390477bacd874">DCOS</a></div><div class="ttdeci">#define DCOS(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00038">ccd_astro.c:38</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a4f290ef8550589b60e07c92fe19e06cd"><div class="ttname"><a href="ccd__astro_8c.html#a4f290ef8550589b60e07c92fe19e06cd">degrad</a></div><div class="ttdeci">#define degrad(x)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00029">ccd_astro.c:29</a></div></div>
<div class="ttc" id="ccd__astro_8c_html_a95f97bc2c6a39966a664c3b924d5eacb"><div class="ttname"><a href="ccd__astro_8c.html#a95f97bc2c6a39966a664c3b924d5eacb">range</a></div><div class="ttdeci">void range(double *v, double r)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00325">ccd_astro.c:325</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a95f97bc2c6a39966a664c3b924d5eacb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void range </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00325">325</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  *v -= r*floor(*v/r);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade7d4965d4cd932c046ad5416b2a75d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int to_uppercase </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>keyword</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nchar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00055">55</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/* forces keyword of length nchar to all uppercase</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">     passes it back in keyword */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">char</span> *pos;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">for</span> (pos =  keyword; pos &lt; (keyword + nchar) ; pos++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    *pos = toupper(*pos);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">return</span>(nchar);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac63bb3146f5155f9ab55477883d6e7fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void year_mjd </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mjd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ccd__astro_8c_source.html#l00440">440</a> of file <a class="el" href="ccd__astro_8c_source.html">ccd_astro.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">double</span> e0, e1;    <span class="comment">/* mjd of start of this year, start of next year */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">int</span> yf = floor (y);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (yf == -1) yf = -2;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a> (1, 1.0, yf, &amp;e0);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a> (1, 1.0, yf+1, &amp;e1);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  *mjd = e0 + (y - yf)*(e1-e0);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="ttc" id="ccd__astro_8c_html_a0c5ebe59481b38a5d393554a2b7ca9a6"><div class="ttname"><a href="ccd__astro_8c.html#a0c5ebe59481b38a5d393554a2b7ca9a6">cal_mjd</a></div><div class="ttdeci">void cal_mjd(int mn, double dy, int yr, double *mjd)</div><div class="ttdef"><b>Definition:</b> <a href="ccd__astro_8c_source.html#l00149">ccd_astro.c:149</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jul 7 2018 18:08:10 for Speckle Instrument Control and GUI by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
